1 Dim PCAL(20)
2 ncnt%=20
3 MTimeout#=5000.0#
4 *PROC_START:
5 M_Timer(1)=0.0#     ' Reset COM timer.
6 Servo On
7 *SRVON:If M_Svo<>1 GoTo *SRVON
8 Mov PCAL(1)     ' Move to start position.
9 Dly 1.0#
10 GoSub *X0     ' Send PC X0
11 Cnt 1
12 Fine 0.5, P
13 For ncal%=1 To ncnt%
14  If PosCq(PCAL(ncal%))<>1 Then GoTo *NEXTPOS
15  Mov PCAL(1)
16  Mov PCAL(ncal%)
17  Dly 0.5#
18  nretry%=0
19  *RECAPT
20  If nretry%>2 GoTo *NEXTPOS
21  GoSub *X1     ' Send PC X1
22  If COK$<>"OK" Then
23   nretry%=nretry%+1
24   GoTo *RECAPT
25  EndIf
26 *NEXTPOS
27 Next ncal%
28 *PROC_END:
29 Fine 0, P
30 Cnt 0
31 Mov PCAL(1)
32 Dly 0.5#
33 Servo Off
34 End
35 ' --------------------------------------------------
36 ' Connect/Disconnect server.
37 ' --------------------------------------------------
38 *COM_OPEN:
39 GoSub *COM_CLOSE
40 M_Timer(1)=0.0#     ' Reset COM timer.
41 Open "COM5:" As #1
42 *WAIT_OPEN:If (M_Open(1)<>1 And M_Timer(1)<MTimeout#) Then GoTo *WAIT_OPEN
43 If M_Open(1)<>1 Then GoTo *COM_OPEN
44 Return
45 *COM_CLOSE:
46 Close
47 Return
48 ' --------------------------------------------------
49 ' [X0] RESET
50 ' --------------------------------------------------
51 *X0
52 GoSub *COM_OPEN
53 Print #1, "X0()"
54 Input #1, COK$    ' Reset OK or not OK.
55 GoSub *COM_CLOSE
56 Return
57 ' --------------------------------------------------
58 ' [X1] CAPTURE
59 ' --------------------------------------------------
60 *X1
61 GoSub *COM_OPEN
62 Print #1, "X1";P_Curr
63 Input #1, COK$    ' Capture OK or not OK.
64 GoSub *COM_CLOSE
65 Return
PCAL(1)=(+294.68,+0.01,+440.22,-180.00,+4.00,+180.00)(7,0)
PCAL(2)=(+450.56,+90.05,+440.92,-170.02,-16.12,+179.90)(7,0)
PCAL(3)=(+285.92,-88.06,+449.87,+170.30,+3.67,-179.97)(7,0)
PCAL(4)=(+400.77,+68.56,+448.77,-171.42,-5.23,+156.39)(7,0)
PCAL(5)=(+235.41,-86.01,+438.63,+169.63,+12.59,-177.16)(7,0)
PCAL(6)=(+270.75,+40.29,+425.84,+177.90,+6.41,+153.40)(7,0)
PCAL(7)=(+308.07,-40.73,+463.33,+178.88,+3.45,-156.59)(7,0)
PCAL(8)=(+400.15,+120.48,+452.22,-166.40,+3.90,+143.07)(7,0)
PCAL(9)=(+270.69,+84.68,+417.54,-176.54,+10.38,+157.71)(7,0)
PCAL(10)=(+341.12,-169.06,+430.19,+156.85,+5.04,-163.96)(7,0)
PCAL(11)=(+370.31,-30.17,+451.86,-178.44,-2.94,-92.96)(7,0)
PCAL(12)=(+382.97,-73.68,+453.97,-178.80,-16.82,+89.12)(7,0)
PCAL(13)=(+171.36,-20.78,+429.13,+176.52,+19.58,+177.51)(7,0)
PCAL(14)=(+453.45,-104.28,+451.41,+169.17,-17.79,+171.67)(7,0)
PCAL(15)=(+250.33,+99.61,+421.83,-169.12,+12.10,+176.29)(7,0)
PCAL(16)=(+266.85,+200.20,+419.30,-158.48,+12.07,+171.43)(7,0)
PCAL(17)=(+410.55,-120.04,+420.32,+163.25,-12.76,+175.41)(7,0)
PCAL(18)=(+460.07,-58.43,+442.15,+169.88,-12.02,-159.45)(7,0)
PCAL(19)=(+270.13,+60.14,+466.19,-178.07,+9.69,+156.02)(7,0)
PCAL(20)=(+450.51,-39.52,+488.23,+172.62,-11.33,-156.55)(7,0)
PDMY=(+0.00,+0.00,+0.00,+0.00,+0.00,+0.00,+0.00,+0.00)(,)
